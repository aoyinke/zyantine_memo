# 重新实现记忆系统的API集成

## 问题分析

当前记忆系统存在以下问题：
1. **API混淆**：memo0需要的OpenAI格式API与记忆评估需要的智谱AI API没有明确区分
2. **调用方式错误**：记忆评估功能使用了直接HTTP请求，而非官方推荐的SDK方式
3. **配置混乱**：配置文件中memo0的LLM配置使用了智谱AI的API，但URL格式可能不正确
4. **代码不一致**：LLMClient初始化时仍尝试传递base_url参数，与之前的修改冲突

## 解决方案

### 1. 重新设计LLMClient类
- **目标**：专门用于记忆评估，使用智谱AI官方SDK
- **修改内容**：
  - 修改`__init__`方法，移除base_url参数
  - 集成`zai`库，使用官方SDK调用智谱AI API
  - 保持现有的评估方法接口不变

### 2. 优化memo0配置
- **目标**：确保memo0使用正确的OpenAI格式API
- **修改内容**：
  - 在配置文件中为memo0选择合适的OpenAI格式API（如DeepSeek）
  - 确保embedder配置使用正确的API

### 3. 从配置文件正确读取API信息
- **目标**：为两个不同的API系统读取各自的配置
- **修改内容**：
  - 修改`ZyantineMemorySystem`初始化方法，分别读取memo0所需API和记忆评估所需API的配置
  - 确保智谱AI API的配置从`api.providers.zhipu`读取

### 4. 代码清理和优化
- **目标**：确保代码一致性和可读性
- **修改内容**：
  - 移除所有不必要的base_url参数传递
  - 确保错误处理和备用逻辑的完整性
  - 添加适当的日志和错误信息

## 实现步骤

1. **安装必要的依赖**：确保`zai`库已安装
2. **修改LLMClient类**：使用智谱AI官方SDK
3. **更新ZyantineMemorySystem初始化**：正确读取两个API的配置
4. **调整配置文件**：确保memo0使用正确的OpenAI格式API
5. **测试系统**：运行测试确保所有功能正常工作

## 预期结果

- memo0能够使用符合OpenAI格式的API正常工作
- 记忆评估功能能够使用智谱AI官方SDK正常工作
- 两个API系统相互独立，不会产生冲突
- 系统能够正确处理API调用失败的情况，使用备用逻辑